{# Agent selector - radio buttons to pick 2 agents to compare #}
{# Expects: agents (list of agent summaries from report) #}

{% if agents | length > 1 %}
<div class="card p-5 mb-6">
    <div class="text-sm font-medium text-text-muted uppercase tracking-wider mb-4">
        Select agents to compare (max 2)
    </div>
    
    {# Agent selection grid #}
    <div class="flex flex-wrap gap-3 mb-6" id="agent-selector">
        {% for agent in agents %}
        <label class="agent-chip {{ 'selected' if loop.index <= 2 else '' }}" data-agent-id="{{ agent.id }}" onclick="updateAgentComparison('{{ agent.id }}'); event.preventDefault();">
            <input type="checkbox" 
                   name="compare-agent" 
                   value="{{ agent.id }}" 
                   {{ 'checked' if loop.index <= 2 else '' }}
                   class="sr-only">
            <span class="chip-content">
                <span class="chip-status {{ 'text-green-400' if agent.pass_rate == 100 else 'text-yellow-400' if agent.pass_rate >= 80 else 'text-red-400' }}">
                    {{ "%.0f"|format(agent.pass_rate) }}%
                </span>
                <span class="chip-name">{{ agent.name }}</span>
                {% if agent.pass_rate == 100 and loop.first %}
                <span class="text-yellow-400">â­</span>
                {% endif %}
            </span>
        </label>
        {% endfor %}
    </div>
    
    {# Selected agent cards - render all, hide non-selected #}
    <div class="grid md:grid-cols-2 gap-4" id="agent-cards">
        {% for agent in agents %}
        {% set is_selected = loop.index <= 2 %}
        <div class="agent-card {{ 'hidden' if not is_selected else '' }} {{ 'winner' if loop.first and agents[0].pass_rate > agents[1].pass_rate else '' }}" 
             data-card-id="{{ agent.id }}">
            <div class="flex justify-between items-start mb-3">
                <div>
                    <div class="text-lg font-medium text-text-light">{{ agent.name }}</div>
                    <div class="flex flex-wrap gap-1.5 mt-2">
                        {% if agent.skill %}
                        <span class="tag tag-skill">ğŸ“š {{ agent.skill }}</span>
                        {% endif %}
                        {% if agent.prompt_name %}
                        <span class="tag tag-prompt">ğŸ“ {{ agent.prompt_name }}</span>
                        {% endif %}
                        {% if not agent.skill and not agent.prompt_name %}
                        <span class="tag tag-default">defaults</span>
                        {% endif %}
                    </div>
                </div>
                {% if loop.first and agents[0].pass_rate >= agents[1].pass_rate %}
                <span class="text-yellow-400 text-xl" title="Best performer">â­</span>
                {% endif %}
            </div>
            <div class="grid grid-cols-2 gap-4 text-sm">
                <div>
                    <span class="{{ 'text-green-400' if agent.pass_rate == 100 else 'text-yellow-400' if agent.pass_rate >= 80 else 'text-red-400' }} text-xl font-semibold">
                        {{ agent.passed }}/{{ agent.total }}
                    </span>
                    <span class="text-text-muted ml-1">{{ "%.0f"|format(agent.pass_rate) }}%</span>
                </div>
                <div class="text-right text-text-muted">
                    <div>{{ format_cost(agent.cost) }}</div>
                    <div>{{ "{:,}".format(agent.tokens) }} tok Â· {{ "%.1f"|format(agent.duration_s) }}s</div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% elif agents | length == 1 %}
{# Single agent - no comparison needed #}
<div class="card p-5 mb-6">
    <div class="flex justify-between items-start">
        <div>
            <div class="text-lg font-medium text-text-light">{{ agents[0].name }}</div>
            <div class="flex flex-wrap gap-1.5 mt-2">
                {% if agents[0].skill %}
                <span class="tag tag-skill">ğŸ“š {{ agents[0].skill }}</span>
                {% endif %}
                {% if agents[0].prompt_name %}
                <span class="tag tag-prompt">ğŸ“ {{ agents[0].prompt_name }}</span>
                {% endif %}
            </div>
        </div>
        <div class="text-right">
            <div class="{{ 'text-green-400' if agents[0].pass_rate == 100 else 'text-red-400' }} text-2xl font-semibold">
                {{ agents[0].passed }}/{{ agents[0].total }}
            </div>
            <div class="text-sm text-text-muted">{{ format_cost(agents[0].cost) }} Â· {{ "{:,}".format(agents[0].tokens) }} tok</div>
        </div>
    </div>
</div>
{% endif %}
